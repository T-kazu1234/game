(function(){var a,b=[].indexOf||function(e){for(var d=0,c=this.length;d<c;d++){if(d in this&&this[d]===e){return d}}return -1};a=(function(){function c(d){this.SPRITES=[];if(d){d.preload([c.CARD])}}c.CARD="images/StandardDeck.png";c.WIDTH=71;c.HEIGHT=96;c.SUIT_SIZE=4;c.NUME_SIZE=13;c.CARD_SIZE=c.SUIT_SIZE*c.NUME_SIZE;c.CLUB=1;c.DIAMOND=2;c.HEART=3;c.SPADE=4;c.ACE=1;c.TEN=10;c.JACK=11;c.QUEEN=12;c.KING=13;c.C01=1;c.C02=2;c.C03=3;c.C04=4;c.C05=5;c.C06=6;c.C07=7;c.C08=8;c.C09=9;c.C10=10;c.C11=11;c.C12=12;c.C13=13;c.D01=14;c.D02=15;c.D03=16;c.D04=17;c.D05=18;c.D06=19;c.D07=20;c.D08=21;c.D09=22;c.D10=23;c.D11=24;c.D12=25;c.D13=26;c.H01=27;c.H02=28;c.H03=29;c.H04=30;c.H05=31;c.H06=32;c.H07=33;c.H08=34;c.H09=35;c.H10=36;c.H11=37;c.H12=38;c.H13=39;c.S01=40;c.S02=41;c.S03=42;c.S04=43;c.S05=44;c.S06=45;c.S07=46;c.S08=47;c.S09=48;c.S10=49;c.S11=50;c.S12=51;c.S13=52;c.JOKER=53;c.C1=c.C01;c.C2=c.C02;c.C3=c.C03;c.C4=c.C04;c.C5=c.C05;c.C6=c.C06;c.C7=c.C07;c.C8=c.C08;c.C9=c.C09;c.CT=c.C10;c.CJ=c.C11;c.CQ=c.C12;c.CK=c.C13;c.D1=c.D01;c.D2=c.D02;c.D3=c.D03;c.D4=c.D04;c.D5=c.D05;c.D6=c.D06;c.D7=c.D07;c.D8=c.D08;c.D9=c.D09;c.DT=c.D10;c.DJ=c.D11;c.DQ=c.D12;c.DK=c.D13;c.H1=c.H01;c.H2=c.H02;c.H3=c.H03;c.H4=c.H04;c.H5=c.H05;c.H6=c.H06;c.H7=c.H07;c.H8=c.H08;c.H9=c.H09;c.HT=c.H10;c.HJ=c.H11;c.HQ=c.H12;c.HK=c.C13;c.S1=c.S01;c.S2=c.S02;c.S3=c.S03;c.S4=c.S04;c.S5=c.S05;c.S6=c.S06;c.S7=c.S07;c.S8=c.S08;c.S9=c.S09;c.ST=c.S10;c.SJ=c.S11;c.SQ=c.C12;c.SK=c.C13;c.prototype.getSuit=function(d){if(d===c.JOKER){return 0}if(d<1||c.CARD_SIZE<d){throw"#--- illegal card:"+d}return Math.floor((d-1)/c.NUME_SIZE)+1};c.prototype.getNumber=function(d){if(d===c.JOKER){return 0}if(d<1||c.CARD_SIZE<d){throw"#--- illegal card:"+d}return(d-1)%c.NUME_SIZE+1};c.prototype.getData=function(e,d){if(e===0||d===0){return c.JOKER}if(e<1||c.SUIT_SIZE<e||d<=0||c.NUME_SIZE<d){throw"#--- illegal suit:"+e+", number:"+d}return(e-1)*c.NUME_SIZE+d};c.prototype.num2name=function(g,d){var i,h,e,f;if(d==null){d=true}if(g===c.JOKER){return"JOKER"}f=["C","D","H","S"];h=["1","2","3","4","5","6","7","8","9","T","J","Q","K"];e=this.getSuit(g);i=this.getNumber(g);if(d){return""+f[e-1]+h[i-1]}else{return""+f[e-1]+i}};c.prototype.num2longname=function(f){var h,g,d,e;if(f===c.JOKER){return"JOKER"}e=["Clubs","Diamonds","Hearts","Spades"];g=["1","2","3","4","5","6","7","8","9","10","Jack","Queen","King"];d=this.getSuit(f);h=this.getNumber(f);return""+g[h-1]+" of "+e[d-1]};c.prototype.name2num=function(d){var g,j,i,h,e,f;if(d==="JOKER"){return c.JOKER}f={C:1,D:2,H:3,S:4};i={"1":1,"2":2,"3":3,"4":4,"5":5,"6":6,"7":7,"8":8,"9":9,T:10,J:11,Q:12,K:13};h={"01":1,"02":2,"03":3,"04":4,"05":5,"06":6,"07":7,"08":8,"09":9,"10":10,"11":11,"12":12,"13":13};g=d.split("");e=f[g[0]];j=null;if(g.length===2){j=i[""+g[1]]}else{if(g.length===3){j=i[""+g[1]];j=h[""+g[1]+g[2]]}}if(e===null||j===null){throw"#--- illegal name "+d}return(e-1)*c.NUME_SIZE+j};c.prototype.getSprite=function(g){var d,f,e;if((g<1||c.CARD_SIZE<g)&&(g!==c.JOKER)){throw"#--- illegal data:"+g}if(this.SPRITES.length===0){for(d=f=1,e=c.CARD_SIZE+1;1<=e?f<=e:f>=e;d=1<=e?++f:--f){this.SPRITES.push(this._getSprite(d))}}return this.SPRITES[g-1]};c.prototype._getSprite=function(h){var f,e,g,d,i;g=c.WIDTH;e=c.HEIGHT;f=new Sprite(g,e);f.image=new Surface(g*2,e);f.data=h;f.name=this.num2name(h);d=h===c.JOKER?0:(this.getNumber(h)-1)*(g+1);i=h===c.JOKER?4*(e+1):(this.getSuit(h)-1)*(e+1);f.image.draw(enchant.Game.instance.assets[c.CARD],d,i,g,e,0,0,g,e);d=5*(g+1);i=4*(e+1);f.image.draw(enchant.Game.instance.assets[c.CARD],d,i,g,e,g,0,g,e);return f};c.prototype.deck=function(){var d,e,g,f;d=[];for(e=g=1,f=c.CARD_SIZE;1<=f?g<=f:g>=f;e=1<=f?++g:--g){d.push(e)}return d};c.prototype.shuffle=function(g){var f,d,e;f=g.length;while(f){d=Math.floor(Math.random()*f,10);e=g[--f];g[f]=g[d];g[d]=e}return g};return c})();$(function(){var k,e,l,d,o,i,c,m,h,n,f,q,g,j,p;enchant();i=new Core(a.WIDTH*13,a.HEIGHT*5);k=new a(i);o=0;h=[];e=[];g=function(s,r){};m=function(r){r.parentNode.removeChild(r);r.tl.moveTo(a.WIDTH*6,a.HEIGHT*4,12);return i.rootScene.addChild(r)};c=function(r){return r.y!==a.HEIGHT*4};f=function(){var A,z,u,r,w,v,t;o=0;for(v=0,t=e.length;v<t;v++){A=e[v];u=k.getSuit(A.data);z=k.getNumber(A.data);r=a.WIDTH*(z-1);w=a.HEIGHT*(u-1);A.tl.moveTo(r,w,12);if(A.frame!==0){A.tl.scaleTo(0.1,1,4);A.tl.then(function(){return this.frame=0});A.tl.scaleTo(1,1,4)}}return null};q=function(){var w,u,r,v,t,s;e=k.shuffle(e);u=0;for(t=0,s=e.length;t<s;t++){w=e[t];if(c(w)){r=(u%13)*a.WIDTH;v=Math.floor(u/13)*a.HEIGHT;w.tl.moveTo(r,v,12);u++}}return null};j=function(s){var u,t,r;for(t=0,r=e.length;t<r;t++){u=e[t];if(c(u)&&u.frame!==s){u.tl.scaleTo(0.1,1,4);u.tl.then(function(){return this.frame=s});u.tl.scaleTo(1,1,4)}}return null};p=function(){return j(1)};n=function(){var u,t,r,s;for(t=0,r=e.length;t<r;t++){u=e[t];if(c(u)&&(u.frame===0)&&(s=u.name,b.call(h,s)>=0)){m(u)}}return null};d=function(r){if(h.length>1){return}if(r.frame===0){return}o++;r.tl.scaleTo(0.1,1,5);r.tl.then(function(){return this.frame=0});r.tl.scaleTo(1,1,5);h.push(k.num2name(r.data,true));if(h.length===2){if(h[0].charAt(1)===h[1].charAt(1)){return setTimeout(function(){n();h=[];if(l()){return alert("Game Overe. clicked = "+o)}},1000)}else{return setTimeout(function(){p();return h=[]},1000)}}};l=function(){var t,s,r;if(e.length===0){return false}for(s=0,r=e.length;s<r;s++){t=e[s];if(c(t)){return false}}return true};$("#reset").click(function(){f();return h=[]});$("#shuffle").click(function(){q();return h=[]});$("#turn-up").click(function(){j(0);return h=[]});$("#turn-down").click(function(){j(1);return h=[]});i.onload=function(){var r,w,t,v,u;for(t=v=1;v<=4;t=++v){for(w=u=1;u<=13;w=++u){r=k.getSprite((t-1)*13+w);r.x=a.WIDTH*(w-1);r.y=a.HEIGHT*(t-1);e.push(r);i.rootScene.addChild(r);r.addEventListener("touchend",function(){return d(this)})}}return null};return i.start()})}).call(this);